function dragNdrop(e){function t(e){i("start"),g(m,"dragNdrop--stop"),f(m,"dragNdrop--start"),document.addEventListener("mousemove",o,!1),document.addEventListener("touchmove",o,!1),document.addEventListener("mouseup",a,!1),document.addEventListener("touchend",a,!1)}function r(e){var t,r=e.style;r.position="absolute",t=N&&"x"===N||"y"===N?"x"===N?"col-resize":"row-resize":"move",r.cursor=t}function o(e){var t;i("drag"),g(m,"dragNdrop--start"),f(m,"dragNdrop--drag"),y&&u(m,y),"touches"in e?(e.preventDefault(),t=e.touches[0]):t=e,d(m,t,N)}function d(e,t,r){var o={h:e.offsetHeight,w:e.offsetWidth},d={x:t.pageX-o.w/2,y:t.pageY-o.h/2};n(e,d,r)}function n(e,t,r){r&&r!==!1?s(e,t,r):(e.style.left=t.x+"px",e.style.top=t.y+"px")}function s(e,t,r){"x"===r?e.style.left=t.x+"px":"y"===r?e.style.top=t.y+"px":"string"==typeof r.innerHTML&&(e.style.left=t.x+"px",e.style.top=t.y+"px",p(e,r,!1))}function p(e,t,r){for(var o=t.getBoundingClientRect(),d={top:t.offsetHeight,left:t.offsetWidth},n=e.getBoundingClientRect(),s={top:e.offsetHeight,left:e.offsetWidth},p=["top","left","top","left"],a=[],u=0,c=p.length;u<c;u++)u<c/2?n[p[u]]>=o[p[u]]?a.push(!0):(a.push(!1),r||(e.style[p[u]]=o[p[u]]+"px")):n[p[u]]+s[p[u]]<=o[p[u]]+d[p[u]]?a.push(!0):(a.push(!1),r||(e.style[p[u]]=o[p[u]]+d[p[u]]-s[p[u]]+"px"));return a.every(function(e){return e===!0})}function a(e){i("stop"),g(m,"dragNdrop--drag"),f(m,"dragNdrop--stop");var t=!1;y&&(t=c(m,y)),E&&E({element:m,dropped:t,dropElements:y,constraints:N,customStyles:h}),document.removeEventListener("mousemove",o,!1),document.removeEventListener("touchmove",o,!1),document.removeEventListener("mouseup",a,!1),document.removeEventListener("touchend",a,!1)}function u(e,t){g(e,"dragNdrop--dropped"),f(e,"dragNdrop--dropable");for(var r=0;r<t.length;r++){var o=t[r];g(o,"dragNdrop__drop--dropped"),f(o,"dragNdrop__drop--ready")}}function c(e,t){function r(e){return!!e&&(s.push(e),!0)}g(e,"dragNdrop--dropable"),g(e,"dragNdrop--dropped");for(var o=[],d=0;d<t.length;d++){var n=t[d];g(n,"dragNdrop__drop--ready"),p(e,n,!0)?(i("dropped"),f(e,"dragNdrop--dropped"),f(n,"dragNdrop__drop--dropped"),o.push(n)):(g(n,"dragNdrop__drop--dropped"),o.push(!1))}var s=[];return!!o.some(r)&&s}function i(e){var t;v?(t=document.createEvent("dragNdrop:"+e),t.initEvent("dragNdrop:"+e,!0,!0)):t=new Event("dragNdrop:"+e),m.dispatchEvent(t)}function l(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function f(e,t){e.classList?e.classList.add(t):l(e,t)||(e.className+=" "+t)}function g(e,t){if(e.classList)e.classList.remove(t);else if(l(e,t)){var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ")}}var v=!1,m=e.element,h=e.customStyles,N=e.constraints,y=e.dropElements,E=e.callback;f(m,"dragNdrop"),h||r(m),m.addEventListener("mousedown",t,!1),m.addEventListener("touchstart",t,!1)}